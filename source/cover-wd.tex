%!TEX root = std.tex
%%--------------------------------------------------
%% Title page for the C++ Standard


\thispagestyle{empty}
\begingroup
\def\hd{\begin{tabular}{ll}
          \textbf{Document Number:} & P1723R2                     \\
          \textbf{Date:}            & \reldate                    \\
          \textbf{Reply to:}        & Marshall Clow               \\
                                    & mclow.lists@gmail.com       \\
                                    & Daniel Sunderland           \\
                                    & Sandia National Laboratory  \\
                                    & dsunder@sandia.gov
          \end{tabular}
}
\newlength{\hdwidth}
\settowidth{\hdwidth}{\hd}
\hfill\begin{minipage}{\hdwidth}\hd\end{minipage}
\endgroup

\vspace{2.5cm}
\begin{center}
\textbf{\Huge
Mandating the Standard Library:\\Clause 31 - Atomics library}
\end{center}

With the adoption of P0788R3, we have a new way of specifying requirements for the
library clauses of the standard. This is one of a series of papers reformulating the
requirements into the new format. This effort was strongly influenced by the informational
paper P1369R0.

The changes in this series of papers fall into three broad categories.
\begin{itemize}
\item{Change "participate in overload resolution" wording into "Constraints" elements}
\item{Change "Requires" elements into either "Mandates" or "Expects", depending (mostly) on whether or not they can be checked at compile time.}
\item{Drive-by fixes (hopefully very few)}
\end{itemize}

This paper covers Clause 31 (Atomics), and is based on N4830.

The entire clause is reproduced here, but the changes are confined to a few sections:

%\begin{multicols}{3}
\begin{itemize}
\item{atomics.ref.generic}		\ref{atomics.ref.generic}
\item{atomics.ref.operations}	\ref{atomics.ref.operations}
\item{atomics.ref.pointer}		\ref{atomics.ref.pointer}
\item{atomics.types.operations}	\ref{atomics.types.operations}
\item{atomics.types.pointer}	\ref{atomics.types.pointer}
\item{atomics.nonmembers}		\ref{atomics.nonmembers}
\item{atomics.flag}				\ref{atomics.flag}
\end{itemize}
%\end{multicols}

Drive-by fixes:
\begin{itemize}
\item{I strengthened the wording in [atomics.ref.generic] \ref{atomics.ref.generic} to require a compile-time failure for non-trivially copyable Ts.}
\item{I removed a "shall" from the definition of \tcode{ATOMIC_INIT} in [atomics.flag] \ref{atomics.flag}.}
\end{itemize}

Open questions:
\begin{itemize}
\item{Should we change all the \tcode{memory_order_seq_cst} to \tcode{memory_order::seq_cst} (and others)? - this will be done via a pull-request post-Belfast. See https://github.com/cplusplus/draft/issues/3365}
\end{itemize}


Changes from R0:
\begin{itemize}
\item{Incorporated changes from P1505, and changed several "is not" into "is neither".}
\item{Updated to N4830.}
\end{itemize}

Changes from R1:
\begin{itemize}
\item{Items from the LWG review at 11-Oct teleconference.}
\end{itemize}

Thanks to Daniel Kr√ºgler for his advice and reviews.

Thanks to Daniel Sunderland for his paper P1505, which suggested similar changes.

\vfill
Help for the editors: The changes here can be viewed as latex sources with the following commands
\begin{verbatim}
git clone git@github.com:mclow/mandate.git
cd mandate
git diff master..chapter31 atomics.tex
\end{verbatim}
